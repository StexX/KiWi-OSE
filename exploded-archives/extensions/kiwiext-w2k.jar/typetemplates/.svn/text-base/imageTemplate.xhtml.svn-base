<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
    xmlns:kiwi="http://www.kiwi-project.eu/jsf"
    xmlns:c="http://java.sun.com/jstl/core"
	xmlns:a="http://richfaces.org/a4j">
	    <h1>
	    	#{contentItem.title}
	    	<h:outputText value=" " />
	    	<s:span style="font-size:65%;">(<kiwi:watcher contentItem="#{contentItem}" />)</s:span>
	    </h1>
        <span>
            <h:outputText value="#{messages['wiki.createdon']} "/><h:outputText value="#{contentItem.created}"><s:convertDateTime pattern="dd/MM/yyyy"/></h:outputText><h:outputText value=" - "/> 
            <h:outputText value="#{messages['wiki.updateon']} "/><h:outputText value="#{contentItem.modified}"><s:convertDateTime pattern="dd/MM/yyyy"/></h:outputText><h:outputText value=" "/> 
            <h:outputText value="#{messages['wiki.by']} "/><kiwi:link resource="#{contentItem.author.resource}" value=" #{contentItem.author.firstName} #{contentItem.author.lastName}"/>
        </span>
        <br />

		<kiwi:tagListEditor label="Tags: " 
			tagItems="#{kiwi.wiki.tagCloudAction.tagCloud}" />
			
        <s:div rendered="#{contentItem.mediaContent != null}" >
            <center>
				<kiwi:mediaContent contentItem="#{contentItem}" 
						edit="true"
						style="padding: 3px; margin:4px;border:solid 1px #ccc;">
					<ui:define name="nomedia">
						<h:outputText value="No image" />
					</ui:define>
					<s:transformImageSize 
						maintainRatio="true"
						width="400"/>
				</kiwi:mediaContent>
		    </center>
		    
		</s:div>
		<center>
		    <rich:togglePanel id="DescriptionEditor" stateOrder="descView,descEdit" switchType="client" initialState="descView">
				<f:facet name="descView">
					<f:subview>
					    <s:div rendered="#{currentContentItem.textContent==null}" style="color:#ccc;">
					    	<rich:toggleControl for="DescriptionEditor">No description yet.</rich:toggleControl>
					    </s:div>
			        	<s:span rendered="#{currentContentItem.textContent!=null}" 
			        		styleClass="ImageDescription">
					    	<rich:toggleControl for="DescriptionEditor">
				        		<kiwi:renderHtml contentItem="#{currentContentItem}" user="#{currentUser}/>
							</rich:toggleControl>
			        	</s:span>
			        </f:subview>
				</f:facet>
				<f:facet name="descEdit">
					<f:subview>
				        <rich:editor id="tag_description"
		                        required = "true"
		                        width    = "110"
		                        height   = "60"
		                        theme    = "advanced"
		                        configuration = "tinymce-small"
		                        plugins  = "safari,pagebreak,style,layer,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,visualchars,nonbreaking,xhtmlxtras"
		                        value    = "#{viewAction.description}">
			            </rich:editor>
			            <a:commandButton action="#{viewAction.saveDescription}" value="Ok" reRender="DescriptionEditor" />
			            <a:commandButton action="#{viewAction.cancelSaveDescription}" value="Cancel" reRender="DescriptionEditor" />
			    	</f:subview>
				</f:facet>
		    </rich:togglePanel>
	    </center>
		<h:panelGrid columns="1">
	        <rich:panel>
				<f:facet name="header">
					Exif metadata
				</f:facet>
				<ui:include src="../widgets/photo.xhtml" />
	        </rich:panel>
		</h:panelGrid>
        <!-- include resource from webservice so that we can support JSF tags inside the content -->
        
</ui:composition>